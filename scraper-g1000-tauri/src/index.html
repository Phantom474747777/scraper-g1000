<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scraper G1000</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <!-- Main App Container -->
    <div id="app" class="app-container">
        <!-- Profile Selection Screen (Initial) -->
        <div id="profile-selector" class="screen active">
            <div class="centered-content">
                <div class="app-logo">
                    <h1 class="app-title">Scraper G1000</h1>
                    <p class="app-subtitle">Business Lead Generation</p>
                </div>

                <div class="profile-list" id="profileList">
                    <!-- Profiles will be loaded here -->
                    <div class="profile-loading">Loading profiles...</div>
                </div>

                <button class="btn-create-profile" id="btnCreateProfile">
                    <span>+ Create New Profile</span>
                </button>
            </div>
        </div>

        <!-- Mode Selection Screen -->
        <div id="mode-selector" class="screen">
            <div class="centered-content">
                <div class="app-logo">
                    <h1 class="app-title">Scraper G1000</h1>
                    <p class="app-subtitle">Lead Generation System</p>
                    <p class="profile-name" id="modeProfileName">CritterCaptures</p>
                </div>

                <div class="mode-selection-grid">
                    <div class="mode-card" id="cardSelectManual">
                        <h2 class="mode-title">Manual Mode</h2>
                        <p class="mode-description">Hand-pick locations, categories, and settings for precise control</p>
                        <div class="mode-features">
                            <div class="feature-item">‚Ä¢ Custom ZIP selection</div>
                            <div class="feature-item">‚Ä¢ Live scraping console</div>
                            <div class="feature-item">‚Ä¢ Real-time progress</div>
                        </div>
                    </div>

                    <div class="mode-card disabled" id="cardSelectAutomation">
                        <h2 class="mode-title">Automation Mode</h2>
                        <p class="mode-description">Set it and forget it with smart automation across multiple targets</p>
                        <div class="mode-features">
                            <div class="feature-item">‚Ä¢ Batch scraping</div>
                            <div class="feature-item">‚Ä¢ Pause/Resume support</div>
                            <div class="feature-item">‚Ä¢ Progress persistence</div>
                        </div>
                        <div class="coming-soon-badge">
                            <span>üöß Coming Soon</span>
                        </div>
                    </div>
                </div>

                <div class="mode-footer">
                    <button class="btn-secondary" id="btnViewLeadsFromMode">View All Leads</button>
                    <button class="btn-back" id="btnBackFromMode">‚Üê Change Profile</button>
                </div>
            </div>
        </div>

        <!-- Manual Scrape Screen (v2.0 Redesign) -->
        <div id="manual-scrape" class="screen">
            <div class="screen-header">
                <button class="btn-back" id="btnBackFromManual">‚Üê Back</button>
                <h1>Manual Mode</h1>
                <div class="hotkey-hints">
                    <button class="btn-reset" id="btnResetManualMode">
                        ‚Üª Reset
                    </button>
                </div>
            </div>

            <div class="manual-content">
                <!-- Left Panel: Configuration -->
                <div class="manual-config-panel">
                    <div class="glass-panel">
                        <h3 class="panel-title">Configuration</h3>

                        <!-- Location Selection -->
                        <div class="config-section">
                            <label class="config-label">City</label>
                            <input type="text" id="inputManualCity" placeholder="Dover" class="glass-input">
                        </div>

                        <div class="config-section">
                            <label class="config-label">State (2-letter)</label>
                            <input type="text" id="inputManualState" placeholder="FL" class="glass-input" maxlength="2">
                        </div>

                        <!-- Radius Slider -->
                        <div class="config-section">
                            <label class="config-label">Search Radius</label>
                            <div class="radius-slider-container">
                                <input type="range" id="inputManualRadius" min="10" max="100" value="50" step="5" class="radius-slider">
                                <div class="radius-value"><span id="radiusValue">50</span> miles</div>
                            </div>
                        </div>

                        <!-- Find ZIPs Button -->
                        <div class="config-section">
                            <button class="btn-find-zips" id="btnFindManualZips">
                                <span>Find ZIP Codes</span>
                            </button>
                        </div>

                        <!-- ZIP Dropdown (appears after finding ZIPs) -->
                        <div class="config-section" id="zipSelectionSection" style="display: none;">
                            <label class="config-label">Select ZIP Code</label>
                            <select id="selectManualZip" class="glass-select">
                                <option value="">Choose a ZIP...</option>
                            </select>
                        </div>

                        <div class="config-section">
                            <label class="config-label">Category</label>
                            <select id="selectManualCategory" class="glass-select">
                                <option value="">Choose a category...</option>
                                <!-- Categories will be loaded from profile data -->
                            </select>
                        </div>

                        <!-- Custom Category Input -->
                        <div class="config-section">
                            <label class="config-label">Or Enter Custom Category</label>
                            <input type="text" id="inputCustomCategory" placeholder="e.g., Tree Services, Electricians..." class="glass-input">
                            <span class="config-hint">Leave blank if using dropdown above</span>
                        </div>

                        <!-- Start Button -->
                        <button class="btn-start-scraping" id="btnStartManualScrape" disabled>
                            <span class="btn-icon">‚ñ∂</span>
                            <span>Start Scraping</span>
                        </button>
                    </div>
                </div>

                <!-- Right Panel: Live Console -->
                <div class="manual-console-panel">
                    <div class="glass-panel console-panel">
                        <div class="console-header">
                            <h3 class="panel-title">Live Console</h3>
                            <div class="console-status" id="consoleStatus">
                                <span class="status-dot status-idle"></span>
                                <span class="status-text">Idle</span>
                            </div>
                        </div>

                        <div class="console-output" id="consoleOutput">
                            <div class="console-line console-system">System Ready</div>
                            <div class="console-line console-system">Configure settings and click Start to begin</div>
                        </div>

                        <!-- Progress Bar (Hidden until scraping) -->
                        <div class="console-progress" id="consoleProgress" style="display: none;">
                            <div class="progress-bar-wrapper">
                                <div class="progress-bar-fill" id="consoleProgressBar" style="width: 0%"></div>
                            </div>
                            <div class="progress-stats">
                                <span id="consoleProgressText">Page 0 of 0</span>
                                <span id="consoleProgressLeads">0 leads</span>
                            </div>
                        </div>

                        <!-- View Leads Button (appears after scraping completes) -->
                        <button class="btn-view-leads" id="btnViewScrapedLeads" style="display: none;">
                            <span class="btn-icon">‚Üí</span>
                            <span>View Leads</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Automation mode screen removed - see .automation_backup/ for restoration -->

        <!-- Leads Dashboard Screen -->
        <div id="leads-dashboard" class="screen">
            <!-- Top Navigation Bar -->
            <div class="leads-header">
                <button class="btn-back" id="btnBackFromLeadsDashboard">‚Üê Back</button>
                <h1>Leads</h1>
            </div>

            <!-- Sticky KPI Bar -->
            <div class="kpi-bar">
                <div class="kpi-card clickable" id="cardAllLeads">
                    <div class="kpi-value" id="cardAllLeadsCount">0</div>
                    <div class="kpi-label">All Leads</div>
                </div>

                <div class="kpi-card clickable" id="cardUncontacted">
                    <div class="kpi-value" id="cardUncontactedCount">0</div>
                    <div class="kpi-label">Uncontacted</div>
                </div>

                <div class="kpi-card clickable" id="cardContacted">
                    <div class="kpi-value" id="cardContactedCount">0</div>
                    <div class="kpi-label">Contacted</div>
                </div>

                <div class="kpi-card clickable" id="cardArchived">
                    <div class="kpi-value" id="cardArchivedCount">0</div>
                    <div class="kpi-label">Archived</div>
                </div>
            </div>

            <!-- Scrollable Content Area -->
            <div class="leads-content">
                <!-- Toggle Section -->
                <div class="view-toggle">
                    <button class="toggle-btn active" id="btnViewZips">By ZIP Code</button>
                    <button class="toggle-btn" id="btnViewCategories">By Category</button>
                    <button class="toggle-btn" id="btnViewCombined">ZIP + Category</button>
                </div>

                <!-- Combined Filter Section (Smart Multi-Filter!) -->
                <div id="combinedSection" class="content-section" style="display: none;">
                    <div class="combined-filter-panel">
                        <div class="filter-row-multi">
                            <div class="filter-col">
                                <label>City</label>
                                <input list="cityList" id="filterCombinedCity" placeholder="Type or select..." class="glass-input">
                                <datalist id="cityList"></datalist>
                            </div>
                            <div class="filter-col">
                                <label>ZIP Code</label>
                                <input list="zipList" id="filterCombinedZip" placeholder="Type or select..." class="glass-input">
                                <datalist id="zipList"></datalist>
                            </div>
                            <div class="filter-col">
                                <label>Category</label>
                                <input list="categoryList" id="filterCombinedCategory" placeholder="Type or select..." class="glass-input">
                                <datalist id="categoryList"></datalist>
                            </div>
                            <div class="filter-col filter-button-col">
                                <button class="btn-primary" id="btnApplyCombinedFilter">Search</button>
                            </div>
                        </div>
                        <div id="combinedResults" class="combined-results"></div>
                    </div>
                </div>

                <!-- By ZIP Code Section -->
                <div id="zipSection" class="content-section">
                    <div class="zip-cards-grid" id="zipCards">
                        <!-- ZIP cards will be loaded here -->
                        <div class="loading-placeholder">Loading ZIP codes...</div>
                    </div>
                </div>

                <!-- By Category Section (Hidden by default) -->
                <div id="categorySection" class="content-section" style="display: none;">
                    <div class="category-cards-grid" id="categoryCards">
                        <!-- Category cards will be loaded here -->
                        <div class="loading-placeholder">Loading categories...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Leads List View -->
        <div id="leads-list" class="screen">
            <div class="screen-header">
                <button class="btn-back" id="btnBackFromList">‚Üê Back</button>
                <div class="breadcrumb" id="breadcrumb">All Leads</div>
                <div class="header-actions">
                    <input type="search" id="searchLeads" placeholder="Search leads..." class="search-field">
                    <button class="btn-primary" id="btnExportLeads">Export ‚Üì</button>
                </div>
            </div>

            <!-- Bulk Actions Toolbar -->
            <div class="bulk-actions-toolbar" id="bulkActionsToolbar" style="display: none;">
                <div class="bulk-actions-left">
                    <span id="bulkSelectedCount">0</span> selected
                </div>
                <div class="bulk-actions-right">
                    <button class="btn-bulk" id="btnBulkContact">Mark Contacted</button>
                    <button class="btn-bulk" id="btnBulkArchive">Archive</button>
                    <button class="btn-bulk" id="btnBulkUnarchive">Unarchive</button>
                </div>
            </div>

            <div class="leads-table-container">
                <table class="leads-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAll"></th>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Category</th>
                            <th>City</th>
                            <th>ZIP</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="leadsTableBody">
                        <tr>
                            <td colspan="7" class="loading">Loading leads...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="table-footer">
                <div>Showing <span id="leadsCount">0</span> leads</div>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Export Leads</h2>
                <button class="modal-close" id="btnCloseExportModal">√ó</button>
            </div>
            <div class="modal-body">
                <div class="export-option-group">
                    <label>Export Scope</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="exportScope" value="current" checked>
                            <span>Current View (<span id="exportCurrentCount">0</span> leads)</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="exportScope" value="selected">
                            <span>Selected Only (<span id="exportSelectedCount">0</span> leads)</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="exportScope" value="all">
                            <span>All Leads (<span id="exportAllCount">0</span> leads)</span>
                        </label>
                    </div>
                </div>

                <div class="export-option-group">
                    <label>File Format</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="exportFormat" value="csv" checked>
                            <span>CSV (.csv)</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="exportFormat" value="xlsx">
                            <span>Excel (.xlsx)</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="btnCancelExport">Cancel</button>
                <button class="btn-primary" id="btnConfirmExport">Export & Save</button>
            </div>
        </div>
    </div>

    <!-- Create Profile Modal -->
    <div class="modal" id="createProfileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Profile</h2>
                <button class="modal-close" id="btnCloseCreateProfileModal">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="profileNameInput">Profile Name</label>
                    <input type="text" id="profileNameInput" class="glass-input" placeholder="Enter profile name..." maxlength="50">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="btnCancelCreateProfile">Cancel</button>
                <button class="btn-primary" id="btnConfirmCreateProfile">Create Profile</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="js/app.js"></script>
</body>
</html>
